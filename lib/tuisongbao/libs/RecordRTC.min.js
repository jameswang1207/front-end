"use strict";function RecordRTC(a,b){function c(){b.disableLogs||console.debug("started recording "+b.type+" stream.");var c;if("undefined"!=typeof StereoRecorder&&isChrome&&(c=StereoRecorder),"undefined"==typeof MediaStreamRecorder||isChrome||(c=MediaStreamRecorder),"video"===b.type&&isChrome){if("undefined"==typeof WhammyRecorder)throw"WhammyRecorder.js seems NOT linked.";c=WhammyRecorder}if("gif"===b.type){if("undefined"==typeof GifRecorder)throw"GifRecorder.js seems NOT linked.";c=GifRecorder}if("canvas"===b.type){if("undefined"==typeof CanvasRecorder)throw"CanvasRecorder.js seems NOT linked.";c=CanvasRecorder}return b.recorderType&&(c=b.recorderType),h=new c(a),h=mergeProps(h,b),h.onAudioProcessStarted=function(){b.onAudioProcessStarted&&b.onAudioProcessStarted()},h.onGifPreview=function(a){b.onGifPreview&&b.onGifPreview(a)},h.record(),i}function d(a){function c(){for(var c in h)i&&(i[c]=h[c]),d&&(d[c]=h[c]);var e=h.blob;if(a){var f=URL.createObjectURL(e);a(f)}e&&!b.disableLogs&&console.debug(e.type,"->",bytesToSize(e.size)),b.autoWriteToDisk&&g(function(a){var c={};c[b.type+"Blob"]=a,DiskStorage.Store(c)})}if(!h)return console.warn(j);var d=this;b.disableLogs||console.warn("Stopped recording "+b.type+" stream."),"gif"!==b.type?h.stop(c):(h.stop(),c())}function e(){return h?void(h.pause?h.pause():b.disableLogs||console.warn('This recording library is having no "pause" method.')):console.warn(j)}function f(){return h?void(h.resume?h.resume():b.disableLogs||console.warn('This recording library is having no "resume" method.')):console.warn(j)}function g(a,c){function d(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}if(!a)throw"Pass a callback function over getDataURL.";var e=c?c.blob:h.blob;if(!e)return b.disableLogs||console.warn("Blob encoder did not yet finished its job."),void setTimeout(function(){g(a,c)},1e3);if("undefined"!=typeof Worker){var f=d(function(a){postMessage((new FileReaderSync).readAsDataURL(a))});f.onmessage=function(b){a(b.data)},f.postMessage(e)}else{var i=new FileReader;i.readAsDataURL(e),i.onload=function(b){a(b.target.result)}}}if(b=b||{},!a)throw"MediaStream is mandatory.";b.type||(b.type="audio");var h,i=this,j='It seems that "startRecording" is not invoked for '+b.type+" recorder.",k={startRecording:c,stopRecording:d,pauseRecording:e,resumeRecording:f,getBlob:function(){return h?h.blob:console.warn(j)},getDataURL:g,toURL:function(){return h?URL.createObjectURL(h.blob):console.warn(j)},save:function(a){if(!h){var b=this;return setTimeout(function(){b.save(a)},2e3),console.warn(j)}var c=document.createElement("a");c.href=URL.createObjectURL(h.blob),c.target="_blank",c.download=(a||Math.round(9999999999*Math.random())+888888888)+"."+h.blob.type.split("/")[1];var d=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});c.dispatchEvent(d);var e;if("undefined"!=typeof URL)e=URL;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";e=webkitURL}e.revokeObjectURL(c.href)},getFromDisk:function(a){return h?void RecordRTC.getFromDisk(b.type,a):console.warn(j)},setAdvertisementArray:function(a){this.advertisement=[];for(var b=a.length,c=0;b>c;c++)this.advertisement.push({duration:c,image:a[c]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,view:null};if(!this)return k;for(var l in k)this[l]=k[l];return k}function MRecordRTC(a){this.addStream=function(b){b&&(a=b)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){!isChrome&&a&&a.getAudioTracks&&a.getAudioTracks().length&&a.getVideoTracks().length&&(this.mediaType.audio=!1),this.mediaType.audio&&(this.audioRecorder=new RecordRTC(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate}),this.audioRecorder.startRecording()),this.mediaType.video&&(this.videoRecorder=new RecordRTC(a,{type:"video",video:this.video,canvas:this.canvas}),this.videoRecorder.startRecording()),this.mediaType.gif&&(this.gifRecorder=new RecordRTC(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10}),this.gifRecorder.startRecording())},this.stopRecording=function(a){a=a||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(b){a(b,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(b){a(b,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(b){a(b,"gif")})},this.getBlob=function(a){var b={};this.audioRecorder&&(b.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(b.video=this.videoRecorder.getBlob()),this.gifRecorder&&(b.gif=this.gifRecorder.getBlob()),a&&a(b)},this.getDataURL=function(a){function b(a,b){if("undefined"!=typeof Worker){var d=c(function(a){postMessage((new FileReaderSync).readAsDataURL(a))});d.onmessage=function(a){b(a.data)},d.postMessage(a)}else{var e=new FileReader;e.readAsDataURL(a),e.onload=function(a){b(a.target.result)}}}function c(a){var b,c=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),d=new Worker(c);if("undefined"!=typeof URL)b=URL;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";b=webkitURL}return b.revokeObjectURL(c),d}this.getBlob(function(c){b(c.audio,function(d){b(c.video,function(b){a({audio:d,video:b})})})})},this.writeToDisk=function(){RecordRTC.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(a){a=a||{audio:!0,video:!0,gif:!0},a.audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof a.audio?a.audio:""),a.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof a.video?a.video:""),a.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof a.gif?a.gif:"")}}function mergeProps(a,b){b=reformatProps(b);for(var c in b)"function"!=typeof b[c]&&(a[c]=b[c]);return a}function reformatProps(a){var b={};for(var c in a)if(-1!==c.indexOf("-")){var d=c.split("-"),e=d[0]+d[1].split("")[0].toUpperCase()+d[1].substr(1);b[e]=a[c]}else b[c]=a[c];return b}function bytesToSize(a){var b=1e3,c=["Bytes","KB","MB","GB","TB"];if(0===a)return"0 Bytes";var d=parseInt(Math.floor(Math.log(a)/Math.log(b)),10);return(a/Math.pow(b,d)).toPrecision(3)+" "+c[d]}function MediaStreamRecorder(a){var b=this;if(b.mimeType&&"video/webm"!==b.mimeType&&a.getVideoTracks&&a.getVideoTracks().length){var c=new AudioContext,d=c.createMediaStreamSource(a),e=c.createMediaStreamDestination();d.connect(e),a=e.stream}var f=!1;this.record=function(){g=new MediaRecorder(a),g.ondataavailable=function(a){if(!f){if(!a.data.size)return void(b.disableLogs||console.warn("Recording of",a.data.type,"failed."));f=!0,b.blob=new Blob([a.data],{type:a.data.type||b.mimeType||"audio/ogg"}),b.callback&&b.callback()}},g.onerror=function(a){b.disableLogs||console.warn(a),g.stop(),b.record(0)},g.start(0),b.onAudioProcessStarted&&b.onAudioProcessStarted()},this.stop=function(a){g&&(this.callback=a,"recording"===g.state&&g.stop())},this.pause=function(){g&&"recording"===g.state&&(g.pause(),this.disableLogs||console.debug("Paused recording."))},this.resume=function(){g&&"paused"===g.state&&(g.resume(),this.disableLogs||console.debug("Resumed recording."))};var g}function StereoRecorder(a){var b=this;this.record=function(){c=new StereoAudioRecorder(a,this),c.onAudioProcessStarted=function(){b.onAudioProcessStarted&&b.onAudioProcessStarted()},c.record()},this.stop=function(a){c&&c.stop(function(){for(var d in c)b[d]=c[d];a&&a()})},this.pause=function(){c&&c.pause()},this.resume=function(){c&&c.resume()};var c}function StereoAudioRecorder(a,b){function c(a,b){function c(a){function b(a,b){for(var c=new Float64Array(b),d=0,e=a.length,f=0;e>f;f++){var g=a[f];c.set(g,d),d+=g.length}return c}function c(a,b){var c=a.length+b.length;c/=h;for(var d=new Float64Array(c),e=0,f=0;c>f;)d[f++]=a[e],d[f++]=b[e],e+=h;return d}function d(a,b,c){for(var d=c.length,e=0;d>e;e++)a.setUint8(b+e,c.charCodeAt(e))}var e=a.leftBuffers,f=a.rightBuffers,g=a.sampleRate,h=a.compression||6;e=b(e[0],e[1]),f=b(f[0],f[1]);var i=c(e,f),j=i.length,k=44+2*j,l=new ArrayBuffer(k),m=new DataView(l);d(m,0,"RIFF");var n=4;m.setUint32(n,44+2*j,!0),d(m,8,"WAVE"),d(m,12,"fmt "),m.setUint32(16,16,!0),m.setUint16(20,1,!0),m.setUint16(22,2,!0),m.setUint32(24,g/h,!0),m.setUint32(28,g/h*n,!0),m.setUint16(32,n,!0),m.setUint16(34,16,!0),d(m,36,"data"),m.setUint32(40,2*j,!0);for(var o,p=44,q=0;j>q;q++,p+=2){var r=Math.max(-1,Math.min(1,i[q])),s=0>r?32768*r:32767*r;a.leftChannel?(s!==o&&m.setInt16(p,s,!0),o=s):m.setInt16(p,s,!0)}postMessage({buffer:l,view:m})}var e=d(c);e.onmessage=function(a){b(a.data.buffer,a.data.view)},e.postMessage(a)}function d(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}if(!a.getAudioTracks().length)throw"Your stream has no audio tracks.";var e=this,f=[],g=[],h=!1,i=0;this.record=function(){f.length=g.length=0,i=0,h=!0},this.stop=function(a){h=!1,k.disconnect(),c({sampleRate:n,leftChannel:b.leftChannel,leftBuffers:[f,i],rightBuffers:[g,i],compression:b.compression},function(b,c){e.blob=new Blob([c],{type:"audio/wav"}),e.buffer=new ArrayBuffer(c),e.view=c,e.sampleRate=n,e.bufferSize=m,e.length=i,a&&a(),p=!1})},Storage.AudioContextConstructor||(Storage.AudioContextConstructor=new Storage.AudioContext);var j=Storage.AudioContextConstructor,k=j.createMediaStreamSource(a),l=[0,256,512,1024,2048,4096,8192,16384],m="undefined"==typeof b.bufferSize?4096:b.bufferSize;-1===l.indexOf(m)&&(b.disableLogs||console.warn("Legal values for buffer-size are "+JSON.stringify(l,null,"	")));var n="undefined"!=typeof b.sampleRate?b.sampleRate:j.sampleRate||44100;if((22050>n||n>96e3)&&(b.disableLogs||console.warn("sample-rate must be under range 22050 and 96000.")),j.createJavaScriptNode)__stereoAudioRecorderJavacriptNode=j.createJavaScriptNode(m,2,2);else{if(!j.createScriptProcessor)throw"WebAudio API has no support on this browser.";__stereoAudioRecorderJavacriptNode=j.createScriptProcessor(m,2,2)}k.connect(__stereoAudioRecorderJavacriptNode),m=__stereoAudioRecorderJavacriptNode.bufferSize,b.disableLogs||(console.log("sample-rate",n),console.log("buffer-size",m));var o=!1;this.pause=function(){o=!0,b.disableLogs||console.debug("Paused recording.")},this.resume=function(){o=!1,b.disableLogs||console.debug("Resumed recording.")};var p=!1;__stereoAudioRecorderJavacriptNode.onaudioprocess=function(b){if(!o){if(a.ended)return void(__stereoAudioRecorderJavacriptNode.onaudioprocess=function(){});if(!h)return void k.disconnect();p||(p=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted());var c=b.inputBuffer.getChannelData(0),d=b.inputBuffer.getChannelData(1);f.push(new Float32Array(c)),g.push(new Float32Array(d)),i+=m}},__stereoAudioRecorderJavacriptNode.connect(j.destination)}function CanvasRecorder(a){function b(){return d?(e=(new Date).getTime(),setTimeout(b,100)):void html2canvas(a,{onrendered:function(a){var d=(new Date).getTime()-e;return d?(e=(new Date).getTime(),f.frames.push({duration:d,image:a.toDataURL("image/webp")}),void(c&&requestAnimationFrame(b))):b()}})}if("undefined"==typeof html2canvas)throw"Please link: //cdn.webrtc-experiment.com/screenshot.js";var c;this.record=function(){c=!0,f.frames=[],b()},this.stop=function(a){c=!1;var b=this;f.compile(function(c){b.blob=c,b.blob.forEach&&(b.blob=new Blob([],{type:"video/webm"})),a&&a(b.blob)})};var d=!1;this.pause=function(){d=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){d=!1,this.disableLogs||console.debug("Resumed recording.")};var e=(new Date).getTime(),f=new Whammy.Video(100)}function WhammyRecorder(a){function b(){var a=(new Date).getTime()-g;return a?e?(g=(new Date).getTime(),setTimeout(b,100)):(g=(new Date).getTime(),f.paused&&f.play(),j.drawImage(f,0,0,i.width,i.height),h.frames.push({duration:a,image:i.toDataURL("image/webp")}),void(d||setTimeout(b,10))):setTimeout(b,10)}function c(a,b,c,d){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;for(var f=e.getContext("2d"),g=[],h=-1===b,j=b&&b>0&&b<=a.length?b:a.length,k={r:0,g:0,b:0},l=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),m=c&&c>=0&&1>=c?c:0,n=d&&d>=0&&1>=d?d:0,o=!1,p=0;j>p;p++){var q,r,s;if(!o){var t=new Image;t.src=a[p].image,f.drawImage(t,0,0,i.width,i.height);var u=f.getImageData(0,0,i.width,i.height);q=0,r=u.data.length,s=u.data.length/4;for(var v=0;r>v;v+=4){var w={r:u.data[v],g:u.data[v+1],b:u.data[v+2]},x=Math.sqrt(Math.pow(w.r-k.r,2)+Math.pow(w.g-k.g,2)+Math.pow(w.b-k.b,2));l*m>=x&&q++}}!o&&s*n>=s-q||(h&&(o=!0),g.push(a[p]))}return g=g.concat(a.slice(j)),g.length<=0&&g.push(a[a.length-1]),g}this.record=function(){this.width||(this.width=320),this.height||(this.height=240),this.video||(this.video={width:this.width,height:this.height}),this.canvas||(this.canvas={width:this.width,height:this.height}),i.width=this.canvas.width,i.height=this.canvas.height,j=i.getContext("2d"),this.video&&this.video instanceof HTMLVideoElement?f=this.video.cloneNode():(f=document.createElement("video"),f.src=URL.createObjectURL(a),f.width=this.video.width,f.height=this.video.height),f.muted=!0,f.play(),g=(new Date).getTime(),h=new Whammy.Video,this.disableLogs||(console.log("canvas resolutions",i.width,"*",i.height),console.log("video width/height",f.width||i.width,"*",f.height||i.height)),b()};var d=!1;this.stop=function(a){d=!0;var b=this;setTimeout(function(){h.frames=c(h.frames,-1),this.advertisement&&this.advertisement.length&&(h.frames=this.advertisement.concat(h.frames)),h.compile(function(c){b.blob=c,b.blob.forEach&&(b.blob=new Blob([],{type:"video/webm"})),a&&a(b.blob)})},10)};var e=!1;this.pause=function(){e=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){e=!1,this.disableLogs||console.debug("Resumed recording.")};var f,g,h,i=document.createElement("canvas"),j=i.getContext("2d")}function GifRecorder(a){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";this.record=function(){function a(f){return b?setTimeout(function(){a(f)},100):(j=requestAnimationFrame(a),void 0===typeof h&&(h=f),void(90>f-h||(e.paused&&e.play(),d.drawImage(e,0,0,c.width,c.height),g.onGifPreview&&g.onGifPreview(c.toDataURL("image/png")),i.addFrame(d),h=f)))}this.width||(this.width=e.offsetWidth||320),this.height||(this.height=e.offsetHeight||240),this.video||(this.video={width:this.width,height:this.height}),this.canvas||(this.canvas={width:this.width,height:this.height}),c.width=this.canvas.width,c.height=this.canvas.height,e.width=this.video.width,e.height=this.video.height,i=new GIFEncoder,i.setRepeat(0),i.setDelay(this.frameRate||200),i.setQuality(this.quality||10),i.start(),f=Date.now();var g=this;j=requestAnimationFrame(a)},this.stop=function(){j&&cancelAnimationFrame(j),g=Date.now(),this.blob=new Blob([new Uint8Array(i.stream().bin)],{type:"image/gif"}),i.stream().bin=[]};var b=!1;this.pause=function(){b=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){b=!1,this.disableLogs||console.debug("Resumed recording.")};var c=document.createElement("canvas"),d=c.getContext("2d"),e=document.createElement("video");e.muted=!0,e.autoplay=!0,e.src=URL.createObjectURL(a),e.play();var f,g,h,i,j=null}function RecordRTC(a,b){function c(){b.disableLogs||console.debug("started recording "+b.type+" stream.");var c;if("undefined"!=typeof StereoRecorder&&isChrome&&(c=StereoRecorder),"undefined"==typeof MediaStreamRecorder||isChrome||(c=MediaStreamRecorder),"video"===b.type&&isChrome){if("undefined"==typeof WhammyRecorder)throw"WhammyRecorder.js seems NOT linked.";c=WhammyRecorder}if("gif"===b.type){if("undefined"==typeof GifRecorder)throw"GifRecorder.js seems NOT linked.";c=GifRecorder}if("canvas"===b.type){if("undefined"==typeof CanvasRecorder)throw"CanvasRecorder.js seems NOT linked.";c=CanvasRecorder}return b.recorderType&&(c=b.recorderType),h=new c(a),h=mergeProps(h,b),h.onAudioProcessStarted=function(){b.onAudioProcessStarted&&b.onAudioProcessStarted()},h.onGifPreview=function(a){b.onGifPreview&&b.onGifPreview(a)},h.record(),i}function d(a){function c(){for(var c in h)i&&(i[c]=h[c]),d&&(d[c]=h[c]);var e=h.blob;if(a){var f=URL.createObjectURL(e);a(f)}e&&!b.disableLogs&&console.debug(e.type,"->",bytesToSize(e.size)),b.autoWriteToDisk&&g(function(a){var c={};c[b.type+"Blob"]=a,DiskStorage.Store(c)})}if(!h)return console.warn(j);var d=this;b.disableLogs||console.warn("Stopped recording "+b.type+" stream."),"gif"!==b.type?h.stop(c):(h.stop(),c())}function e(){return h?void(h.pause?h.pause():b.disableLogs||console.warn('This recording library is having no "pause" method.')):console.warn(j)}function f(){return h?void(h.resume?h.resume():b.disableLogs||console.warn('This recording library is having no "resume" method.')):console.warn(j)}function g(a,c){function d(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}if(!a)throw"Pass a callback function over getDataURL.";var e=c?c.blob:h.blob;if(!e)return b.disableLogs||console.warn("Blob encoder did not yet finished its job."),void setTimeout(function(){g(a,c)},1e3);if("undefined"!=typeof Worker){var f=d(function(a){postMessage((new FileReaderSync).readAsDataURL(a))});f.onmessage=function(b){a(b.data)},f.postMessage(e)}else{var i=new FileReader;i.readAsDataURL(e),i.onload=function(b){a(b.target.result)}}}if(b=b||{},!a)throw"MediaStream is mandatory.";b.type||(b.type="audio");var h,i=this,j='It seems that "startRecording" is not invoked for '+b.type+" recorder.",k={startRecording:c,stopRecording:d,pauseRecording:e,resumeRecording:f,getBlob:function(){return h?h.blob:console.warn(j)},getDataURL:g,toURL:function(){return h?URL.createObjectURL(h.blob):console.warn(j)},save:function(a){if(!h){var b=this;return setTimeout(function(){b.save(a)},2e3),console.warn(j)}var c=document.createElement("a");c.href=URL.createObjectURL(h.blob),c.target="_blank",c.download=(a||Math.round(9999999999*Math.random())+888888888)+"."+h.blob.type.split("/")[1];var d=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});c.dispatchEvent(d);var e;if("undefined"!=typeof URL)e=URL;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";e=webkitURL}e.revokeObjectURL(c.href)},getFromDisk:function(a){return h?void RecordRTC.getFromDisk(b.type,a):console.warn(j)},setAdvertisementArray:function(a){this.advertisement=[];for(var b=a.length,c=0;b>c;c++)this.advertisement.push({duration:c,image:a[c]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,view:null};if(!this)return k;for(var l in k)this[l]=k[l];return k}function MRecordRTC(a){this.addStream=function(b){b&&(a=b)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){!isChrome&&a&&a.getAudioTracks&&a.getAudioTracks().length&&a.getVideoTracks().length&&(this.mediaType.audio=!1),this.mediaType.audio&&(this.audioRecorder=new RecordRTC(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate}),this.audioRecorder.startRecording()),this.mediaType.video&&(this.videoRecorder=new RecordRTC(a,{type:"video",video:this.video,canvas:this.canvas}),this.videoRecorder.startRecording()),this.mediaType.gif&&(this.gifRecorder=new RecordRTC(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10}),this.gifRecorder.startRecording())},this.stopRecording=function(a){a=a||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(b){a(b,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(b){a(b,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(b){a(b,"gif")})},this.getBlob=function(a){var b={};this.audioRecorder&&(b.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(b.video=this.videoRecorder.getBlob()),this.gifRecorder&&(b.gif=this.gifRecorder.getBlob()),a&&a(b)},this.getDataURL=function(a){function b(a,b){if("undefined"!=typeof Worker){var d=c(function(a){postMessage((new FileReaderSync).readAsDataURL(a))});d.onmessage=function(a){b(a.data)},d.postMessage(a)}else{var e=new FileReader;e.readAsDataURL(a),e.onload=function(a){b(a.target.result)}}}function c(a){var b,c=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),d=new Worker(c);if("undefined"!=typeof URL)b=URL;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";b=webkitURL}return b.revokeObjectURL(c),d}this.getBlob(function(c){b(c.audio,function(d){b(c.video,function(b){a({audio:d,video:b})})})})},this.writeToDisk=function(){RecordRTC.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(a){a=a||{audio:!0,video:!0,gif:!0},a.audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof a.audio?a.audio:""),a.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof a.video?a.video:""),a.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof a.gif?a.gif:"")}}function mergeProps(a,b){b=reformatProps(b);for(var c in b)"function"!=typeof b[c]&&(a[c]=b[c]);return a}function reformatProps(a){var b={};for(var c in a)if(-1!==c.indexOf("-")){var d=c.split("-"),e=d[0]+d[1].split("")[0].toUpperCase()+d[1].substr(1);b[e]=a[c]}else b[c]=a[c];return b}function bytesToSize(a){var b=1e3,c=["Bytes","KB","MB","GB","TB"];if(0===a)return"0 Bytes";var d=parseInt(Math.floor(Math.log(a)/Math.log(b)),10);return(a/Math.pow(b,d)).toPrecision(3)+" "+c[d]}function MediaStreamRecorder(a){var b=this;if(b.mimeType&&"video/webm"!==b.mimeType&&a.getVideoTracks&&a.getVideoTracks().length){var c=new AudioContext,d=c.createMediaStreamSource(a),e=c.createMediaStreamDestination();d.connect(e),a=e.stream}var f=!1;this.record=function(){g=new MediaRecorder(a),g.ondataavailable=function(a){if(!f){if(!a.data.size)return void(b.disableLogs||console.warn("Recording of",a.data.type,"failed."));f=!0,b.blob=new Blob([a.data],{type:a.data.type||b.mimeType||"audio/ogg"}),b.callback&&b.callback()}},g.onerror=function(a){b.disableLogs||console.warn(a),g.stop(),b.record(0)},g.start(0),b.onAudioProcessStarted&&b.onAudioProcessStarted()},this.stop=function(a){g&&(this.callback=a,"recording"===g.state&&g.stop())},this.pause=function(){g&&"recording"===g.state&&(g.pause(),this.disableLogs||console.debug("Paused recording."))},this.resume=function(){g&&"paused"===g.state&&(g.resume(),this.disableLogs||console.debug("Resumed recording."))};var g}function StereoRecorder(a){var b=this;this.record=function(){c=new StereoAudioRecorder(a,this),c.onAudioProcessStarted=function(){b.onAudioProcessStarted&&b.onAudioProcessStarted()},c.record()},this.stop=function(a){c&&c.stop(function(){for(var d in c)b[d]=c[d];a&&a()})},this.pause=function(){c&&c.pause()},this.resume=function(){c&&c.resume()};var c}function StereoAudioRecorder(a,b){function c(a,b){function c(a){function b(a,b){for(var c=new Float64Array(b),d=0,e=a.length,f=0;e>f;f++){var g=a[f];c.set(g,d),d+=g.length}return c}function c(a,b){var c=a.length+b.length;c/=h;for(var d=new Float64Array(c),e=0,f=0;c>f;)d[f++]=a[e],d[f++]=b[e],e+=h;return d}function d(a,b,c){for(var d=c.length,e=0;d>e;e++)a.setUint8(b+e,c.charCodeAt(e))}var e=a.leftBuffers,f=a.rightBuffers,g=a.sampleRate,h=a.compression||6;e=b(e[0],e[1]),f=b(f[0],f[1]);var i=c(e,f),j=i.length,k=44+2*j,l=new ArrayBuffer(k),m=new DataView(l);d(m,0,"RIFF");var n=4;m.setUint32(n,44+2*j,!0),d(m,8,"WAVE"),d(m,12,"fmt "),m.setUint32(16,16,!0),m.setUint16(20,1,!0),m.setUint16(22,2,!0),m.setUint32(24,g/h,!0),m.setUint32(28,g/h*n,!0),m.setUint16(32,n,!0),m.setUint16(34,16,!0),d(m,36,"data"),m.setUint32(40,2*j,!0);for(var o,p=44,q=0;j>q;q++,p+=2){var r=Math.max(-1,Math.min(1,i[q])),s=0>r?32768*r:32767*r;a.leftChannel?(s!==o&&m.setInt16(p,s,!0),o=s):m.setInt16(p,s,!0)}postMessage({buffer:l,view:m})}var e=d(c);e.onmessage=function(a){b(a.data.buffer,a.data.view)},e.postMessage(a)}function d(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}if(!a.getAudioTracks().length)throw"Your stream has no audio tracks.";var e=this,f=[],g=[],h=!1,i=0;this.record=function(){f.length=g.length=0,i=0,h=!0},this.stop=function(a){h=!1,k.disconnect(),c({sampleRate:n,leftChannel:b.leftChannel,leftBuffers:[f,i],rightBuffers:[g,i],compression:b.compression},function(b,c){e.blob=new Blob([c],{type:"audio/wav"}),e.buffer=new ArrayBuffer(c),e.view=c,e.sampleRate=n,e.bufferSize=m,e.length=i,a&&a(),p=!1})},Storage.AudioContextConstructor||(Storage.AudioContextConstructor=new Storage.AudioContext);var j=Storage.AudioContextConstructor,k=j.createMediaStreamSource(a),l=[0,256,512,1024,2048,4096,8192,16384],m="undefined"==typeof b.bufferSize?4096:b.bufferSize;-1===l.indexOf(m)&&(b.disableLogs||console.warn("Legal values for buffer-size are "+JSON.stringify(l,null,"	")));var n="undefined"!=typeof b.sampleRate?b.sampleRate:j.sampleRate||44100;if((22050>n||n>96e3)&&(b.disableLogs||console.warn("sample-rate must be under range 22050 and 96000.")),j.createJavaScriptNode)__stereoAudioRecorderJavacriptNode=j.createJavaScriptNode(m,2,2);else{if(!j.createScriptProcessor)throw"WebAudio API has no support on this browser.";__stereoAudioRecorderJavacriptNode=j.createScriptProcessor(m,2,2)}k.connect(__stereoAudioRecorderJavacriptNode),m=__stereoAudioRecorderJavacriptNode.bufferSize,b.disableLogs||(console.log("sample-rate",n),console.log("buffer-size",m));var o=!1;this.pause=function(){o=!0,b.disableLogs||console.debug("Paused recording.")},this.resume=function(){o=!1,b.disableLogs||console.debug("Resumed recording.")};var p=!1;__stereoAudioRecorderJavacriptNode.onaudioprocess=function(b){if(!o){if(a.ended)return void(__stereoAudioRecorderJavacriptNode.onaudioprocess=function(){});if(!h)return void k.disconnect();p||(p=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted());var c=b.inputBuffer.getChannelData(0),d=b.inputBuffer.getChannelData(1);f.push(new Float32Array(c)),g.push(new Float32Array(d)),i+=m}},__stereoAudioRecorderJavacriptNode.connect(j.destination)}function CanvasRecorder(a){function b(){return d?(e=(new Date).getTime(),setTimeout(b,100)):void html2canvas(a,{onrendered:function(a){var d=(new Date).getTime()-e;return d?(e=(new Date).getTime(),f.frames.push({duration:d,image:a.toDataURL("image/webp")}),void(c&&requestAnimationFrame(b))):b()}})}if("undefined"==typeof html2canvas)throw"Please link: //cdn.webrtc-experiment.com/screenshot.js";var c;this.record=function(){c=!0,f.frames=[],b()},this.stop=function(a){c=!1;var b=this;f.compile(function(c){b.blob=c,b.blob.forEach&&(b.blob=new Blob([],{type:"video/webm"})),a&&a(b.blob)})};var d=!1;this.pause=function(){d=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){d=!1,this.disableLogs||console.debug("Resumed recording.")};var e=(new Date).getTime(),f=new Whammy.Video(100)}function WhammyRecorder(a){function b(){var a=(new Date).getTime()-g;return a?e?(g=(new Date).getTime(),setTimeout(b,100)):(g=(new Date).getTime(),f.paused&&f.play(),j.drawImage(f,0,0,i.width,i.height),h.frames.push({duration:a,image:i.toDataURL("image/webp")}),void(d||setTimeout(b,10))):setTimeout(b,10)}function c(a,b,c,d){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;for(var f=e.getContext("2d"),g=[],h=-1===b,j=b&&b>0&&b<=a.length?b:a.length,k={r:0,g:0,b:0},l=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),m=c&&c>=0&&1>=c?c:0,n=d&&d>=0&&1>=d?d:0,o=!1,p=0;j>p;p++){var q,r,s;if(!o){var t=new Image;t.src=a[p].image,f.drawImage(t,0,0,i.width,i.height);var u=f.getImageData(0,0,i.width,i.height);q=0,r=u.data.length,s=u.data.length/4;for(var v=0;r>v;v+=4){var w={r:u.data[v],g:u.data[v+1],b:u.data[v+2]},x=Math.sqrt(Math.pow(w.r-k.r,2)+Math.pow(w.g-k.g,2)+Math.pow(w.b-k.b,2));l*m>=x&&q++}}!o&&s*n>=s-q||(h&&(o=!0),g.push(a[p]))}return g=g.concat(a.slice(j)),g.length<=0&&g.push(a[a.length-1]),g}this.record=function(){this.width||(this.width=320),this.height||(this.height=240),this.video||(this.video={width:this.width,height:this.height}),this.canvas||(this.canvas={width:this.width,height:this.height}),i.width=this.canvas.width,i.height=this.canvas.height,j=i.getContext("2d"),this.video&&this.video instanceof HTMLVideoElement?f=this.video.cloneNode():(f=document.createElement("video"),f.src=URL.createObjectURL(a),f.width=this.video.width,f.height=this.video.height),f.muted=!0,f.play(),g=(new Date).getTime(),h=new Whammy.Video,this.disableLogs||(console.log("canvas resolutions",i.width,"*",i.height),console.log("video width/height",f.width||i.width,"*",f.height||i.height)),b()};var d=!1;this.stop=function(a){d=!0;var b=this;setTimeout(function(){h.frames=c(h.frames,-1),this.advertisement&&this.advertisement.length&&(h.frames=this.advertisement.concat(h.frames)),h.compile(function(c){b.blob=c,b.blob.forEach&&(b.blob=new Blob([],{type:"video/webm"})),a&&a(b.blob)})},10)};var e=!1;this.pause=function(){e=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){e=!1,this.disableLogs||console.debug("Resumed recording.")};var f,g,h,i=document.createElement("canvas"),j=i.getContext("2d")}function GifRecorder(a){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";this.record=function(){function a(f){return b?setTimeout(function(){a(f)},100):(j=requestAnimationFrame(a),void 0===typeof h&&(h=f),void(90>f-h||(e.paused&&e.play(),d.drawImage(e,0,0,c.width,c.height),g.onGifPreview&&g.onGifPreview(c.toDataURL("image/png")),i.addFrame(d),h=f)))}this.width||(this.width=e.offsetWidth||320),this.height||(this.height=e.offsetHeight||240),this.video||(this.video={width:this.width,height:this.height}),this.canvas||(this.canvas={width:this.width,height:this.height}),c.width=this.canvas.width,c.height=this.canvas.height,e.width=this.video.width,e.height=this.video.height,i=new GIFEncoder,i.setRepeat(0),i.setDelay(this.frameRate||200),i.setQuality(this.quality||10),i.start(),f=Date.now();var g=this;j=requestAnimationFrame(a)},this.stop=function(){j&&cancelAnimationFrame(j),g=Date.now(),this.blob=new Blob([new Uint8Array(i.stream().bin)],{type:"image/gif"}),i.stream().bin=[]};var b=!1;this.pause=function(){b=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){b=!1,this.disableLogs||console.debug("Resumed recording.")};var c=document.createElement("canvas"),d=c.getContext("2d"),e=document.createElement("video");e.muted=!0,e.autoplay=!0,e.src=URL.createObjectURL(a),e.play();var f,g,h,i,j=null}function RecordRTC(a,b){function c(){b.disableLogs||console.debug("started recording "+b.type+" stream.");var c;if("undefined"!=typeof StereoRecorder&&isChrome&&(c=StereoRecorder),"undefined"==typeof MediaStreamRecorder||isChrome||(c=MediaStreamRecorder),"video"===b.type&&isChrome){if("undefined"==typeof WhammyRecorder)throw"WhammyRecorder.js seems NOT linked.";c=WhammyRecorder}if("gif"===b.type){if("undefined"==typeof GifRecorder)throw"GifRecorder.js seems NOT linked.";c=GifRecorder}if("canvas"===b.type){if("undefined"==typeof CanvasRecorder)throw"CanvasRecorder.js seems NOT linked.";c=CanvasRecorder}return b.recorderType&&(c=b.recorderType),h=new c(a),h=mergeProps(h,b),h.onAudioProcessStarted=function(){b.onAudioProcessStarted&&b.onAudioProcessStarted()},h.onGifPreview=function(a){b.onGifPreview&&b.onGifPreview(a)},h.record(),i}function d(a){function c(){for(var c in h)i&&(i[c]=h[c]),d&&(d[c]=h[c]);var e=h.blob;if(a){var f=URL.createObjectURL(e);a(f)}e&&!b.disableLogs&&console.debug(e.type,"->",bytesToSize(e.size)),b.autoWriteToDisk&&g(function(a){var c={};c[b.type+"Blob"]=a,DiskStorage.Store(c)})}if(!h)return console.warn(j);var d=this;b.disableLogs||console.warn("Stopped recording "+b.type+" stream."),
"gif"!==b.type?h.stop(c):(h.stop(),c())}function e(){return h?void(h.pause?h.pause():b.disableLogs||console.warn('This recording library is having no "pause" method.')):console.warn(j)}function f(){return h?void(h.resume?h.resume():b.disableLogs||console.warn('This recording library is having no "resume" method.')):console.warn(j)}function g(a,c){function d(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}if(!a)throw"Pass a callback function over getDataURL.";var e=c?c.blob:h.blob;if(!e)return b.disableLogs||console.warn("Blob encoder did not yet finished its job."),void setTimeout(function(){g(a,c)},1e3);if("undefined"!=typeof Worker){var f=d(function(a){postMessage((new FileReaderSync).readAsDataURL(a))});f.onmessage=function(b){a(b.data)},f.postMessage(e)}else{var i=new FileReader;i.readAsDataURL(e),i.onload=function(b){a(b.target.result)}}}if(b=b||{},!a)throw"MediaStream is mandatory.";b.type||(b.type="audio");var h,i=this,j='It seems that "startRecording" is not invoked for '+b.type+" recorder.",k={startRecording:c,stopRecording:d,pauseRecording:e,resumeRecording:f,getBlob:function(){return h?h.blob:console.warn(j)},getDataURL:g,toURL:function(){return h?URL.createObjectURL(h.blob):console.warn(j)},save:function(a){if(!h){var b=this;return setTimeout(function(){b.save(a)},2e3),console.warn(j)}var c=document.createElement("a");c.href=URL.createObjectURL(h.blob),c.target="_blank",c.download=(a||Math.round(9999999999*Math.random())+888888888)+"."+h.blob.type.split("/")[1];var d=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});c.dispatchEvent(d);var e;if("undefined"!=typeof URL)e=URL;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";e=webkitURL}e.revokeObjectURL(c.href)},getFromDisk:function(a){return h?void RecordRTC.getFromDisk(b.type,a):console.warn(j)},setAdvertisementArray:function(a){this.advertisement=[];for(var b=a.length,c=0;b>c;c++)this.advertisement.push({duration:c,image:a[c]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,view:null};if(!this)return k;for(var l in k)this[l]=k[l];return k}function MRecordRTC(a){this.addStream=function(b){b&&(a=b)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){!isChrome&&a&&a.getAudioTracks&&a.getAudioTracks().length&&a.getVideoTracks().length&&(this.mediaType.audio=!1),this.mediaType.audio&&(this.audioRecorder=new RecordRTC(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate}),this.audioRecorder.startRecording()),this.mediaType.video&&(this.videoRecorder=new RecordRTC(a,{type:"video",video:this.video,canvas:this.canvas}),this.videoRecorder.startRecording()),this.mediaType.gif&&(this.gifRecorder=new RecordRTC(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10}),this.gifRecorder.startRecording())},this.stopRecording=function(a){a=a||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(b){a(b,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(b){a(b,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(b){a(b,"gif")})},this.getBlob=function(a){var b={};this.audioRecorder&&(b.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(b.video=this.videoRecorder.getBlob()),this.gifRecorder&&(b.gif=this.gifRecorder.getBlob()),a&&a(b)},this.getDataURL=function(a){function b(a,b){if("undefined"!=typeof Worker){var d=c(function(a){postMessage((new FileReaderSync).readAsDataURL(a))});d.onmessage=function(a){b(a.data)},d.postMessage(a)}else{var e=new FileReader;e.readAsDataURL(a),e.onload=function(a){b(a.target.result)}}}function c(a){var b,c=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),d=new Worker(c);if("undefined"!=typeof URL)b=URL;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";b=webkitURL}return b.revokeObjectURL(c),d}this.getBlob(function(c){b(c.audio,function(d){b(c.video,function(b){a({audio:d,video:b})})})})},this.writeToDisk=function(){RecordRTC.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(a){a=a||{audio:!0,video:!0,gif:!0},a.audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof a.audio?a.audio:""),a.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof a.video?a.video:""),a.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof a.gif?a.gif:"")}}function mergeProps(a,b){b=reformatProps(b);for(var c in b)"function"!=typeof b[c]&&(a[c]=b[c]);return a}function reformatProps(a){var b={};for(var c in a)if(-1!==c.indexOf("-")){var d=c.split("-"),e=d[0]+d[1].split("")[0].toUpperCase()+d[1].substr(1);b[e]=a[c]}else b[c]=a[c];return b}function bytesToSize(a){var b=1e3,c=["Bytes","KB","MB","GB","TB"];if(0===a)return"0 Bytes";var d=parseInt(Math.floor(Math.log(a)/Math.log(b)),10);return(a/Math.pow(b,d)).toPrecision(3)+" "+c[d]}function MediaStreamRecorder(a){var b=this;if(b.mimeType&&"video/webm"!==b.mimeType&&a.getVideoTracks&&a.getVideoTracks().length){var c=new AudioContext,d=c.createMediaStreamSource(a),e=c.createMediaStreamDestination();d.connect(e),a=e.stream}var f=!1;this.record=function(){g=new MediaRecorder(a),g.ondataavailable=function(a){if(!f){if(!a.data.size)return void(b.disableLogs||console.warn("Recording of",a.data.type,"failed."));f=!0,b.blob=new Blob([a.data],{type:a.data.type||b.mimeType||"audio/ogg"}),b.callback&&b.callback()}},g.onerror=function(a){b.disableLogs||console.warn(a),g.stop(),b.record(0)},g.start(0),b.onAudioProcessStarted&&b.onAudioProcessStarted()},this.stop=function(a){g&&(this.callback=a,"recording"===g.state&&g.stop())},this.pause=function(){g&&"recording"===g.state&&(g.pause(),this.disableLogs||console.debug("Paused recording."))},this.resume=function(){g&&"paused"===g.state&&(g.resume(),this.disableLogs||console.debug("Resumed recording."))};var g}function StereoRecorder(a){var b=this;this.record=function(){c=new StereoAudioRecorder(a,this),c.onAudioProcessStarted=function(){b.onAudioProcessStarted&&b.onAudioProcessStarted()},c.record()},this.stop=function(a){c&&c.stop(function(){for(var d in c)b[d]=c[d];a&&a()})},this.pause=function(){c&&c.pause()},this.resume=function(){c&&c.resume()};var c}function StereoAudioRecorder(a,b){function c(a,b){function c(a){function b(a,b){for(var c=new Float64Array(b),d=0,e=a.length,f=0;e>f;f++){var g=a[f];c.set(g,d),d+=g.length}return c}function c(a,b){var c=a.length+b.length;c/=h;for(var d=new Float64Array(c),e=0,f=0;c>f;)d[f++]=a[e],d[f++]=b[e],e+=h;return d}function d(a,b,c){for(var d=c.length,e=0;d>e;e++)a.setUint8(b+e,c.charCodeAt(e))}var e=a.leftBuffers,f=a.rightBuffers,g=a.sampleRate,h=a.compression||6;e=b(e[0],e[1]),f=b(f[0],f[1]);var i=c(e,f),j=i.length,k=44+2*j,l=new ArrayBuffer(k),m=new DataView(l);d(m,0,"RIFF");var n=4;m.setUint32(n,44+2*j,!0),d(m,8,"WAVE"),d(m,12,"fmt "),m.setUint32(16,16,!0),m.setUint16(20,1,!0),m.setUint16(22,2,!0),m.setUint32(24,g/h,!0),m.setUint32(28,g/h*n,!0),m.setUint16(32,n,!0),m.setUint16(34,16,!0),d(m,36,"data"),m.setUint32(40,2*j,!0);for(var o,p=44,q=0;j>q;q++,p+=2){var r=Math.max(-1,Math.min(1,i[q])),s=0>r?32768*r:32767*r;a.leftChannel?(s!==o&&m.setInt16(p,s,!0),o=s):m.setInt16(p,s,!0)}postMessage({buffer:l,view:m})}var e=d(c);e.onmessage=function(a){b(a.data.buffer,a.data.view)},e.postMessage(a)}function d(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}if(!a.getAudioTracks().length)throw"Your stream has no audio tracks.";var e=this,f=[],g=[],h=!1,i=0;this.record=function(){f.length=g.length=0,i=0,h=!0},this.stop=function(a){h=!1,k.disconnect(),c({sampleRate:n,leftChannel:b.leftChannel,leftBuffers:[f,i],rightBuffers:[g,i],compression:b.compression},function(b,c){e.blob=new Blob([c],{type:"audio/wav"}),e.buffer=new ArrayBuffer(c),e.view=c,e.sampleRate=n,e.bufferSize=m,e.length=i,a&&a(),p=!1})},Storage.AudioContextConstructor||(Storage.AudioContextConstructor=new Storage.AudioContext);var j=Storage.AudioContextConstructor,k=j.createMediaStreamSource(a),l=[0,256,512,1024,2048,4096,8192,16384],m="undefined"==typeof b.bufferSize?4096:b.bufferSize;-1===l.indexOf(m)&&(b.disableLogs||console.warn("Legal values for buffer-size are "+JSON.stringify(l,null,"	")));var n="undefined"!=typeof b.sampleRate?b.sampleRate:j.sampleRate||44100;if((22050>n||n>96e3)&&(b.disableLogs||console.warn("sample-rate must be under range 22050 and 96000.")),j.createJavaScriptNode)__stereoAudioRecorderJavacriptNode=j.createJavaScriptNode(m,2,2);else{if(!j.createScriptProcessor)throw"WebAudio API has no support on this browser.";__stereoAudioRecorderJavacriptNode=j.createScriptProcessor(m,2,2)}k.connect(__stereoAudioRecorderJavacriptNode),m=__stereoAudioRecorderJavacriptNode.bufferSize,b.disableLogs||(console.log("sample-rate",n),console.log("buffer-size",m));var o=!1;this.pause=function(){o=!0,b.disableLogs||console.debug("Paused recording.")},this.resume=function(){o=!1,b.disableLogs||console.debug("Resumed recording.")};var p=!1;__stereoAudioRecorderJavacriptNode.onaudioprocess=function(b){if(!o){if(a.ended)return void(__stereoAudioRecorderJavacriptNode.onaudioprocess=function(){});if(!h)return void k.disconnect();p||(p=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted());var c=b.inputBuffer.getChannelData(0),d=b.inputBuffer.getChannelData(1);f.push(new Float32Array(c)),g.push(new Float32Array(d)),i+=m}},__stereoAudioRecorderJavacriptNode.connect(j.destination)}function CanvasRecorder(a){function b(){return d?(e=(new Date).getTime(),setTimeout(b,100)):void html2canvas(a,{onrendered:function(a){var d=(new Date).getTime()-e;return d?(e=(new Date).getTime(),f.frames.push({duration:d,image:a.toDataURL("image/webp")}),void(c&&requestAnimationFrame(b))):b()}})}if("undefined"==typeof html2canvas)throw"Please link: //cdn.webrtc-experiment.com/screenshot.js";var c;this.record=function(){c=!0,f.frames=[],b()},this.stop=function(a){c=!1;var b=this;f.compile(function(c){b.blob=c,b.blob.forEach&&(b.blob=new Blob([],{type:"video/webm"})),a&&a(b.blob)})};var d=!1;this.pause=function(){d=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){d=!1,this.disableLogs||console.debug("Resumed recording.")};var e=(new Date).getTime(),f=new Whammy.Video(100)}function WhammyRecorder(a){function b(){var a=(new Date).getTime()-g;return a?e?(g=(new Date).getTime(),setTimeout(b,100)):(g=(new Date).getTime(),f.paused&&f.play(),j.drawImage(f,0,0,i.width,i.height),h.frames.push({duration:a,image:i.toDataURL("image/webp")}),void(d||setTimeout(b,10))):setTimeout(b,10)}function c(a,b,c,d){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;for(var f=e.getContext("2d"),g=[],h=-1===b,j=b&&b>0&&b<=a.length?b:a.length,k={r:0,g:0,b:0},l=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),m=c&&c>=0&&1>=c?c:0,n=d&&d>=0&&1>=d?d:0,o=!1,p=0;j>p;p++){var q,r,s;if(!o){var t=new Image;t.src=a[p].image,f.drawImage(t,0,0,i.width,i.height);var u=f.getImageData(0,0,i.width,i.height);q=0,r=u.data.length,s=u.data.length/4;for(var v=0;r>v;v+=4){var w={r:u.data[v],g:u.data[v+1],b:u.data[v+2]},x=Math.sqrt(Math.pow(w.r-k.r,2)+Math.pow(w.g-k.g,2)+Math.pow(w.b-k.b,2));l*m>=x&&q++}}!o&&s*n>=s-q||(h&&(o=!0),g.push(a[p]))}return g=g.concat(a.slice(j)),g.length<=0&&g.push(a[a.length-1]),g}this.record=function(){this.width||(this.width=320),this.height||(this.height=240),this.video||(this.video={width:this.width,height:this.height}),this.canvas||(this.canvas={width:this.width,height:this.height}),i.width=this.canvas.width,i.height=this.canvas.height,j=i.getContext("2d"),this.video&&this.video instanceof HTMLVideoElement?f=this.video.cloneNode():(f=document.createElement("video"),f.src=URL.createObjectURL(a),f.width=this.video.width,f.height=this.video.height),f.muted=!0,f.play(),g=(new Date).getTime(),h=new Whammy.Video,this.disableLogs||(console.log("canvas resolutions",i.width,"*",i.height),console.log("video width/height",f.width||i.width,"*",f.height||i.height)),b()};var d=!1;this.stop=function(a){d=!0;var b=this;setTimeout(function(){h.frames=c(h.frames,-1),this.advertisement&&this.advertisement.length&&(h.frames=this.advertisement.concat(h.frames)),h.compile(function(c){b.blob=c,b.blob.forEach&&(b.blob=new Blob([],{type:"video/webm"})),a&&a(b.blob)})},10)};var e=!1;this.pause=function(){e=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){e=!1,this.disableLogs||console.debug("Resumed recording.")};var f,g,h,i=document.createElement("canvas"),j=i.getContext("2d")}function GifRecorder(a){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";this.record=function(){function a(f){return b?setTimeout(function(){a(f)},100):(j=requestAnimationFrame(a),void 0===typeof h&&(h=f),void(90>f-h||(e.paused&&e.play(),d.drawImage(e,0,0,c.width,c.height),g.onGifPreview&&g.onGifPreview(c.toDataURL("image/png")),i.addFrame(d),h=f)))}this.width||(this.width=e.offsetWidth||320),this.height||(this.height=e.offsetHeight||240),this.video||(this.video={width:this.width,height:this.height}),this.canvas||(this.canvas={width:this.width,height:this.height}),c.width=this.canvas.width,c.height=this.canvas.height,e.width=this.video.width,e.height=this.video.height,i=new GIFEncoder,i.setRepeat(0),i.setDelay(this.frameRate||200),i.setQuality(this.quality||10),i.start(),f=Date.now();var g=this;j=requestAnimationFrame(a)},this.stop=function(){j&&cancelAnimationFrame(j),g=Date.now(),this.blob=new Blob([new Uint8Array(i.stream().bin)],{type:"image/gif"}),i.stream().bin=[]};var b=!1;this.pause=function(){b=!0,this.disableLogs||console.debug("Paused recording.")},this.resume=function(){b=!1,this.disableLogs||console.debug("Resumed recording.")};var c=document.createElement("canvas"),d=c.getContext("2d"),e=document.createElement("video");e.muted=!0,e.autoplay=!0,e.src=URL.createObjectURL(a),e.play();var f,g,h,i,j=null}if(RecordRTC.getFromDisk=function(a,b){if(!b)throw"callback is mandatory.";console.log("Getting recorded "+("all"===a?"blobs":a+" blob ")+" from disk!"),DiskStorage.Fetch(function(c,d){"all"!==a&&d===a+"Blob"&&b&&b(c),"all"===a&&b&&b(c,d.replace("Blob",""))})},RecordRTC.writeToDisk=function(a){console.log("Writing recorded blob(s) to disk!"),a=a||{},a.audio&&a.video&&a.gif?a.audio.getDataURL(function(b){a.video.getDataURL(function(c){a.gif.getDataURL(function(a){DiskStorage.Store({audioBlob:b,videoBlob:c,gifBlob:a})})})}):a.audio&&a.video?a.audio.getDataURL(function(b){a.video.getDataURL(function(a){DiskStorage.Store({audioBlob:b,videoBlob:a})})}):a.audio&&a.gif?a.audio.getDataURL(function(b){a.gif.getDataURL(function(a){DiskStorage.Store({audioBlob:b,gifBlob:a})})}):a.video&&a.gif?a.video.getDataURL(function(b){a.gif.getDataURL(function(a){DiskStorage.Store({videoBlob:b,gifBlob:a})})}):a.audio?a.audio.getDataURL(function(a){DiskStorage.Store({audioBlob:a})}):a.video?a.video.getDataURL(function(a){DiskStorage.Store({videoBlob:a})}):a.gif&&a.gif.getDataURL(function(a){DiskStorage.Store({gifBlob:a})})},"undefined"!=typeof module&&(module.exports=RecordRTC),MRecordRTC.getFromDisk=RecordRTC.getFromDisk,MRecordRTC.writeToDisk=RecordRTC.writeToDisk,"undefined"==typeof requestAnimationFrame){if("undefined"!=typeof webkitRequestAnimationFrame)var requestAnimationFrame=webkitRequestAnimationFrame;if("undefined"!=typeof mozRequestAnimationFrame)var requestAnimationFrame=mozRequestAnimationFrame}if("undefined"==typeof cancelAnimationFrame){if("undefined"!=typeof webkitCancelAnimationFrame)var cancelAnimationFrame=webkitCancelAnimationFrame;if("undefined"!=typeof mozCancelAnimationFrame)var cancelAnimationFrame=mozCancelAnimationFrame}if("undefined"==typeof AudioContext){if("undefined"!=typeof webkitAudioContext)var AudioContext=webkitAudioContext;if("undefined"!=typeof mozAudioContext)var AudioContext=mozAudioContext}if("undefined"==typeof URL&&"undefined"!=typeof webkitURL)var URL=webkitURL;var isChrome=!0;if("undefined"!=typeof navigator)"undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia),isChrome="undefined"!=typeof navigator.webkitGetUserMedia;else var navigator={getUserMedia:{}};if("undefined"!=typeof webkitMediaStream)var MediaStream=webkitMediaStream;"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var Storage={};"undefined"!=typeof AudioContext?Storage.AudioContext=AudioContext:"undefined"!=typeof webkitAudioContext&&(Storage.AudioContext=webkitAudioContext);var __stereoAudioRecorderJavacriptNode,Whammy=function(){function a(a){this.frames=[],this.duration=a||1,this.quality=100}function b(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}function c(a){function b(a){var b=d(a);if(!b)return[];for(var e=3e4,f=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:m(b.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:b.width,id:176},{data:b.height,id:186}]}]}]}]}],g=0,i=0;g<a.length;){var j=[],k=0;do j.push(a[g]),k+=a[g].duration,g++;while(g<a.length&&e>k);var l=0,n={id:524531317,data:c(i,l,j)};f[1].data.push(n),i+=k}return h(f)}function c(a,b,c){return[{data:a,id:231}].concat(c.map(function(a){var c=i({discardable:0,frame:a.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(b)});return b+=a.duration,{data:c,id:163}}))}function d(a){if(!a[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var b=a[0].width,c=a[0].height,d=a[0].duration,e=1;e<a.length;e++)d+=a[e].duration;return{duration:d,width:b,height:c}}function e(a){for(var b=[];a>0;)b.push(255&a),a>>=8;return new Uint8Array(b.reverse())}function f(a){return new Uint8Array(a.split("").map(function(a){return a.charCodeAt(0)}))}function g(a){var b=[],c=a.length%8?new Array(9-a.length%8).join("0"):"";a=c+a;for(var d=0;d<a.length;d+=8)b.push(parseInt(a.substr(d,8),2));return new Uint8Array(b)}function h(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].data;"object"==typeof d&&(d=h(d)),"number"==typeof d&&(d=g(d.toString(2))),"string"==typeof d&&(d=f(d));var i=d.size||d.byteLength||d.length,j=Math.ceil(Math.ceil(Math.log(i)/Math.log(2))/8),k=i.toString(2),l=new Array(7*j+7+1-k.length).join("0")+k,m=new Array(j).join("0")+"1"+l;b.push(e(a[c].id)),b.push(g(m)),b.push(d)}return new Blob(b,{type:"video/webm"})}function i(a){var b=0;if(a.keyframe&&(b|=128),a.invisible&&(b|=8),a.lacing&&(b|=a.lacing<<1),a.discardable&&(b|=1),a.trackNum>127)throw"TrackNumber > 127 not supported";var c=[128|a.trackNum,a.timecode>>8,255&a.timecode,b].map(function(a){return String.fromCharCode(a)}).join("")+a.frame;return c}function j(a){for(var b=a.RIFF[0].WEBP[0],c=b.indexOf("*"),d=0,e=[];4>d;d++)e[d]=b.charCodeAt(c+3+d);var f,g,h;return h=e[1]<<8|e[0],f=16383&h,h=e[3]<<8|e[2],g=16383&h,{width:f,height:g,data:b,riff:a}}function k(a,b){return parseInt(a.substr(b+4,4).split("").map(function(a){var b=a.charCodeAt(0).toString(2);return new Array(8-b.length+1).join("0")+b}).join(""),2)}function l(a){for(var b=0,c={};b<a.length;){var d=a.substr(b,4),e=k(a,b),f=a.substr(b+4+4,e);b+=8+e,c[d]=c[d]||[],"RIFF"===d||"LIST"===d?c[d].push(l(f)):c[d].push(f)}return c}function m(a){return[].slice.call(new Uint8Array(new Float64Array([a]).buffer),0).map(function(a){return String.fromCharCode(a)}).reverse().join("")}var n=new b(a.map(function(a){var b=j(l(atob(a.image.slice(23))));return b.duration=a.duration,b}));postMessage(n)}return a.prototype.add=function(a,b){if("canvas"in a&&(a=a.canvas),"toDataURL"in a&&(a=a.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(a))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:a,duration:b||this.duration})},a.prototype.compile=function(a){var d=b(c);d.onmessage=function(b){return b.data.error?void console.error(b.data.error):void a(b.data)},d.postMessage(this.frames)},{Video:a}}(),DiskStorage={init:function(){function a(a){a.createObjectStore(d.dataStoreName)}function b(){function a(a){b.objectStore(d.dataStoreName).get(a).onsuccess=function(b){d.callback&&d.callback(b.target.result,a)}}var b=e.transaction([d.dataStoreName],"readwrite");d.videoBlob&&b.objectStore(d.dataStoreName).put(d.videoBlob,"videoBlob"),d.gifBlob&&b.objectStore(d.dataStoreName).put(d.gifBlob,"gifBlob"),d.audioBlob&&b.objectStore(d.dataStoreName).put(d.audioBlob,"audioBlob"),a("audioBlob"),a("videoBlob"),a("gifBlob")}var c,d=this;"undefined"!=typeof webkitIndexedDB&&(c=webkitIndexedDB),"undefined"!=typeof mozIndexedDB&&(c=mozIndexedDB),"undefined"!=typeof OIndexedDB&&(c=OIndexedDB),"undefined"!=typeof msIndexedDB&&(c=msIndexedDB);var e,f=1,g=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),h=c.open(g,f);h.onerror=d.onError,h.onsuccess=function(){if(e=h.result,e.onerror=d.onError,e.setVersion)if(e.version!==f){var c=e.setVersion(f);c.onsuccess=function(){a(e),b()}}else b();else b()},h.onupgradeneeded=function(b){a(b.target.result)}},Fetch:function(a){return this.callback=a,this.init(),this},Store:function(a){return this.audioBlob=a.audioBlob,this.videoBlob=a.videoBlob,this.gifBlob=a.gifBlob,this.init(),this},onError:function(a){console.error(JSON.stringify(a,null,"	"))},dataStoreName:"recordRTC",dbName:null};if(RecordRTC.getFromDisk=function(a,b){if(!b)throw"callback is mandatory.";console.log("Getting recorded "+("all"===a?"blobs":a+" blob ")+" from disk!"),DiskStorage.Fetch(function(c,d){"all"!==a&&d===a+"Blob"&&b&&b(c),"all"===a&&b&&b(c,d.replace("Blob",""))})},RecordRTC.writeToDisk=function(a){console.log("Writing recorded blob(s) to disk!"),a=a||{},a.audio&&a.video&&a.gif?a.audio.getDataURL(function(b){a.video.getDataURL(function(c){a.gif.getDataURL(function(a){DiskStorage.Store({audioBlob:b,videoBlob:c,gifBlob:a})})})}):a.audio&&a.video?a.audio.getDataURL(function(b){a.video.getDataURL(function(a){DiskStorage.Store({audioBlob:b,videoBlob:a})})}):a.audio&&a.gif?a.audio.getDataURL(function(b){a.gif.getDataURL(function(a){DiskStorage.Store({audioBlob:b,gifBlob:a})})}):a.video&&a.gif?a.video.getDataURL(function(b){a.gif.getDataURL(function(a){DiskStorage.Store({videoBlob:b,gifBlob:a})})}):a.audio?a.audio.getDataURL(function(a){DiskStorage.Store({audioBlob:a})}):a.video?a.video.getDataURL(function(a){DiskStorage.Store({videoBlob:a})}):a.gif&&a.gif.getDataURL(function(a){DiskStorage.Store({gifBlob:a})})},"undefined"!=typeof module&&(module.exports=RecordRTC),MRecordRTC.getFromDisk=RecordRTC.getFromDisk,MRecordRTC.writeToDisk=RecordRTC.writeToDisk,"undefined"==typeof requestAnimationFrame){if("undefined"!=typeof webkitRequestAnimationFrame)var requestAnimationFrame=webkitRequestAnimationFrame;if("undefined"!=typeof mozRequestAnimationFrame)var requestAnimationFrame=mozRequestAnimationFrame}if("undefined"==typeof cancelAnimationFrame){if("undefined"!=typeof webkitCancelAnimationFrame)var cancelAnimationFrame=webkitCancelAnimationFrame;if("undefined"!=typeof mozCancelAnimationFrame)var cancelAnimationFrame=mozCancelAnimationFrame}if("undefined"==typeof AudioContext){if("undefined"!=typeof webkitAudioContext)var AudioContext=webkitAudioContext;if("undefined"!=typeof mozAudioContext)var AudioContext=mozAudioContext}if("undefined"==typeof URL&&"undefined"!=typeof webkitURL)var URL=webkitURL;var isChrome=!0;if("undefined"!=typeof navigator)"undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia),isChrome="undefined"!=typeof navigator.webkitGetUserMedia;else var navigator={getUserMedia:{}};if("undefined"!=typeof webkitMediaStream)var MediaStream=webkitMediaStream;"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var Storage={};"undefined"!=typeof AudioContext?Storage.AudioContext=AudioContext:"undefined"!=typeof webkitAudioContext&&(Storage.AudioContext=webkitAudioContext);var __stereoAudioRecorderJavacriptNode,Whammy=function(){function a(a){this.frames=[],this.duration=a||1,this.quality=100}function b(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}function c(a){function b(a){var b=d(a);if(!b)return[];for(var e=3e4,f=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:m(b.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:b.width,id:176},{data:b.height,id:186}]}]}]}]}],g=0,i=0;g<a.length;){var j=[],k=0;do j.push(a[g]),k+=a[g].duration,g++;while(g<a.length&&e>k);var l=0,n={id:524531317,data:c(i,l,j)};f[1].data.push(n),i+=k}return h(f)}function c(a,b,c){return[{data:a,id:231}].concat(c.map(function(a){var c=i({discardable:0,frame:a.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(b)});return b+=a.duration,{data:c,id:163}}))}function d(a){if(!a[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var b=a[0].width,c=a[0].height,d=a[0].duration,e=1;e<a.length;e++)d+=a[e].duration;return{duration:d,width:b,height:c}}function e(a){for(var b=[];a>0;)b.push(255&a),a>>=8;return new Uint8Array(b.reverse())}function f(a){return new Uint8Array(a.split("").map(function(a){return a.charCodeAt(0)}))}function g(a){var b=[],c=a.length%8?new Array(9-a.length%8).join("0"):"";a=c+a;for(var d=0;d<a.length;d+=8)b.push(parseInt(a.substr(d,8),2));return new Uint8Array(b)}function h(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].data;"object"==typeof d&&(d=h(d)),"number"==typeof d&&(d=g(d.toString(2))),"string"==typeof d&&(d=f(d));var i=d.size||d.byteLength||d.length,j=Math.ceil(Math.ceil(Math.log(i)/Math.log(2))/8),k=i.toString(2),l=new Array(7*j+7+1-k.length).join("0")+k,m=new Array(j).join("0")+"1"+l;b.push(e(a[c].id)),b.push(g(m)),b.push(d)}return new Blob(b,{type:"video/webm"})}function i(a){var b=0;if(a.keyframe&&(b|=128),a.invisible&&(b|=8),a.lacing&&(b|=a.lacing<<1),a.discardable&&(b|=1),a.trackNum>127)throw"TrackNumber > 127 not supported";var c=[128|a.trackNum,a.timecode>>8,255&a.timecode,b].map(function(a){return String.fromCharCode(a)}).join("")+a.frame;return c}function j(a){for(var b=a.RIFF[0].WEBP[0],c=b.indexOf("*"),d=0,e=[];4>d;d++)e[d]=b.charCodeAt(c+3+d);var f,g,h;return h=e[1]<<8|e[0],f=16383&h,h=e[3]<<8|e[2],g=16383&h,{width:f,height:g,data:b,riff:a}}function k(a,b){return parseInt(a.substr(b+4,4).split("").map(function(a){var b=a.charCodeAt(0).toString(2);return new Array(8-b.length+1).join("0")+b}).join(""),2)}function l(a){for(var b=0,c={};b<a.length;){var d=a.substr(b,4),e=k(a,b),f=a.substr(b+4+4,e);b+=8+e,c[d]=c[d]||[],"RIFF"===d||"LIST"===d?c[d].push(l(f)):c[d].push(f)}return c}function m(a){return[].slice.call(new Uint8Array(new Float64Array([a]).buffer),0).map(function(a){return String.fromCharCode(a)}).reverse().join("")}var n=new b(a.map(function(a){var b=j(l(atob(a.image.slice(23))));return b.duration=a.duration,b}));postMessage(n)}return a.prototype.add=function(a,b){if("canvas"in a&&(a=a.canvas),"toDataURL"in a&&(a=a.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(a))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:a,duration:b||this.duration})},a.prototype.compile=function(a){var d=b(c);d.onmessage=function(b){return b.data.error?void console.error(b.data.error):void a(b.data)},d.postMessage(this.frames)},{Video:a}}(),DiskStorage={init:function(){function a(a){a.createObjectStore(d.dataStoreName)}function b(){function a(a){b.objectStore(d.dataStoreName).get(a).onsuccess=function(b){d.callback&&d.callback(b.target.result,a)}}var b=e.transaction([d.dataStoreName],"readwrite");d.videoBlob&&b.objectStore(d.dataStoreName).put(d.videoBlob,"videoBlob"),d.gifBlob&&b.objectStore(d.dataStoreName).put(d.gifBlob,"gifBlob"),d.audioBlob&&b.objectStore(d.dataStoreName).put(d.audioBlob,"audioBlob"),a("audioBlob"),a("videoBlob"),a("gifBlob")}var c,d=this;"undefined"!=typeof webkitIndexedDB&&(c=webkitIndexedDB),"undefined"!=typeof mozIndexedDB&&(c=mozIndexedDB),"undefined"!=typeof OIndexedDB&&(c=OIndexedDB),"undefined"!=typeof msIndexedDB&&(c=msIndexedDB);var e,f=1,g=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),h=c.open(g,f);h.onerror=d.onError,h.onsuccess=function(){if(e=h.result,e.onerror=d.onError,e.setVersion)if(e.version!==f){var c=e.setVersion(f);c.onsuccess=function(){a(e),b()}}else b();else b()},h.onupgradeneeded=function(b){a(b.target.result)}},Fetch:function(a){return this.callback=a,this.init(),this},Store:function(a){return this.audioBlob=a.audioBlob,this.videoBlob=a.videoBlob,this.gifBlob=a.gifBlob,this.init(),this},onError:function(a){console.error(JSON.stringify(a,null,"	"))},dataStoreName:"recordRTC",dbName:null};if(RecordRTC.getFromDisk=function(a,b){if(!b)throw"callback is mandatory.";console.log("Getting recorded "+("all"===a?"blobs":a+" blob ")+" from disk!"),DiskStorage.Fetch(function(c,d){"all"!==a&&d===a+"Blob"&&b&&b(c),"all"===a&&b&&b(c,d.replace("Blob",""))})},RecordRTC.writeToDisk=function(a){console.log("Writing recorded blob(s) to disk!"),a=a||{},a.audio&&a.video&&a.gif?a.audio.getDataURL(function(b){a.video.getDataURL(function(c){a.gif.getDataURL(function(a){DiskStorage.Store({audioBlob:b,videoBlob:c,gifBlob:a})})})}):a.audio&&a.video?a.audio.getDataURL(function(b){a.video.getDataURL(function(a){DiskStorage.Store({audioBlob:b,videoBlob:a})})}):a.audio&&a.gif?a.audio.getDataURL(function(b){a.gif.getDataURL(function(a){DiskStorage.Store({audioBlob:b,gifBlob:a})})}):a.video&&a.gif?a.video.getDataURL(function(b){a.gif.getDataURL(function(a){DiskStorage.Store({videoBlob:b,gifBlob:a})})}):a.audio?a.audio.getDataURL(function(a){DiskStorage.Store({audioBlob:a})}):a.video?a.video.getDataURL(function(a){DiskStorage.Store({videoBlob:a})}):a.gif&&a.gif.getDataURL(function(a){DiskStorage.Store({gifBlob:a})})},"undefined"!=typeof module&&(module.exports=RecordRTC),MRecordRTC.getFromDisk=RecordRTC.getFromDisk,MRecordRTC.writeToDisk=RecordRTC.writeToDisk,"undefined"==typeof requestAnimationFrame){if("undefined"!=typeof webkitRequestAnimationFrame)var requestAnimationFrame=webkitRequestAnimationFrame;if("undefined"!=typeof mozRequestAnimationFrame)var requestAnimationFrame=mozRequestAnimationFrame}if("undefined"==typeof cancelAnimationFrame){if("undefined"!=typeof webkitCancelAnimationFrame)var cancelAnimationFrame=webkitCancelAnimationFrame;if("undefined"!=typeof mozCancelAnimationFrame)var cancelAnimationFrame=mozCancelAnimationFrame}if("undefined"==typeof AudioContext){if("undefined"!=typeof webkitAudioContext)var AudioContext=webkitAudioContext;
if("undefined"!=typeof mozAudioContext)var AudioContext=mozAudioContext}if("undefined"==typeof URL&&"undefined"!=typeof webkitURL)var URL=webkitURL;var isChrome=!0;if("undefined"!=typeof navigator)"undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia),isChrome="undefined"!=typeof navigator.webkitGetUserMedia;else var navigator={getUserMedia:{}};if("undefined"!=typeof webkitMediaStream)var MediaStream=webkitMediaStream;"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var Storage={};"undefined"!=typeof AudioContext?Storage.AudioContext=AudioContext:"undefined"!=typeof webkitAudioContext&&(Storage.AudioContext=webkitAudioContext);var __stereoAudioRecorderJavacriptNode,Whammy=function(){function a(a){this.frames=[],this.duration=a||1,this.quality=100}function b(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}function c(a){function b(a){var b=d(a);if(!b)return[];for(var e=3e4,f=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:m(b.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:b.width,id:176},{data:b.height,id:186}]}]}]}]}],g=0,i=0;g<a.length;){var j=[],k=0;do j.push(a[g]),k+=a[g].duration,g++;while(g<a.length&&e>k);var l=0,n={id:524531317,data:c(i,l,j)};f[1].data.push(n),i+=k}return h(f)}function c(a,b,c){return[{data:a,id:231}].concat(c.map(function(a){var c=i({discardable:0,frame:a.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(b)});return b+=a.duration,{data:c,id:163}}))}function d(a){if(!a[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var b=a[0].width,c=a[0].height,d=a[0].duration,e=1;e<a.length;e++)d+=a[e].duration;return{duration:d,width:b,height:c}}function e(a){for(var b=[];a>0;)b.push(255&a),a>>=8;return new Uint8Array(b.reverse())}function f(a){return new Uint8Array(a.split("").map(function(a){return a.charCodeAt(0)}))}function g(a){var b=[],c=a.length%8?new Array(9-a.length%8).join("0"):"";a=c+a;for(var d=0;d<a.length;d+=8)b.push(parseInt(a.substr(d,8),2));return new Uint8Array(b)}function h(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].data;"object"==typeof d&&(d=h(d)),"number"==typeof d&&(d=g(d.toString(2))),"string"==typeof d&&(d=f(d));var i=d.size||d.byteLength||d.length,j=Math.ceil(Math.ceil(Math.log(i)/Math.log(2))/8),k=i.toString(2),l=new Array(7*j+7+1-k.length).join("0")+k,m=new Array(j).join("0")+"1"+l;b.push(e(a[c].id)),b.push(g(m)),b.push(d)}return new Blob(b,{type:"video/webm"})}function i(a){var b=0;if(a.keyframe&&(b|=128),a.invisible&&(b|=8),a.lacing&&(b|=a.lacing<<1),a.discardable&&(b|=1),a.trackNum>127)throw"TrackNumber > 127 not supported";var c=[128|a.trackNum,a.timecode>>8,255&a.timecode,b].map(function(a){return String.fromCharCode(a)}).join("")+a.frame;return c}function j(a){for(var b=a.RIFF[0].WEBP[0],c=b.indexOf("*"),d=0,e=[];4>d;d++)e[d]=b.charCodeAt(c+3+d);var f,g,h;return h=e[1]<<8|e[0],f=16383&h,h=e[3]<<8|e[2],g=16383&h,{width:f,height:g,data:b,riff:a}}function k(a,b){return parseInt(a.substr(b+4,4).split("").map(function(a){var b=a.charCodeAt(0).toString(2);return new Array(8-b.length+1).join("0")+b}).join(""),2)}function l(a){for(var b=0,c={};b<a.length;){var d=a.substr(b,4),e=k(a,b),f=a.substr(b+4+4,e);b+=8+e,c[d]=c[d]||[],"RIFF"===d||"LIST"===d?c[d].push(l(f)):c[d].push(f)}return c}function m(a){return[].slice.call(new Uint8Array(new Float64Array([a]).buffer),0).map(function(a){return String.fromCharCode(a)}).reverse().join("")}var n=new b(a.map(function(a){var b=j(l(atob(a.image.slice(23))));return b.duration=a.duration,b}));postMessage(n)}return a.prototype.add=function(a,b){if("canvas"in a&&(a=a.canvas),"toDataURL"in a&&(a=a.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(a))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:a,duration:b||this.duration})},a.prototype.compile=function(a){var d=b(c);d.onmessage=function(b){return b.data.error?void console.error(b.data.error):void a(b.data)},d.postMessage(this.frames)},{Video:a}}(),DiskStorage={init:function(){function a(a){a.createObjectStore(d.dataStoreName)}function b(){function a(a){b.objectStore(d.dataStoreName).get(a).onsuccess=function(b){d.callback&&d.callback(b.target.result,a)}}var b=e.transaction([d.dataStoreName],"readwrite");d.videoBlob&&b.objectStore(d.dataStoreName).put(d.videoBlob,"videoBlob"),d.gifBlob&&b.objectStore(d.dataStoreName).put(d.gifBlob,"gifBlob"),d.audioBlob&&b.objectStore(d.dataStoreName).put(d.audioBlob,"audioBlob"),a("audioBlob"),a("videoBlob"),a("gifBlob")}var c,d=this;"undefined"!=typeof webkitIndexedDB&&(c=webkitIndexedDB),"undefined"!=typeof mozIndexedDB&&(c=mozIndexedDB),"undefined"!=typeof OIndexedDB&&(c=OIndexedDB),"undefined"!=typeof msIndexedDB&&(c=msIndexedDB);var e,f=1,g=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),h=c.open(g,f);h.onerror=d.onError,h.onsuccess=function(){if(e=h.result,e.onerror=d.onError,e.setVersion)if(e.version!==f){var c=e.setVersion(f);c.onsuccess=function(){a(e),b()}}else b();else b()},h.onupgradeneeded=function(b){a(b.target.result)}},Fetch:function(a){return this.callback=a,this.init(),this},Store:function(a){return this.audioBlob=a.audioBlob,this.videoBlob=a.videoBlob,this.gifBlob=a.gifBlob,this.init(),this},onError:function(a){console.error(JSON.stringify(a,null,"	"))},dataStoreName:"recordRTC",dbName:null};
//# sourceMappingURL=RecordRTC.min.js.map